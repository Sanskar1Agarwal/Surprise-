<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Realistic Cake Cutting</title>
<style>
    body {
        font-family: Arial, sans-serif;
        text-align: center;
        background-color: #fff8f0;
        padding: 30px;
    }
    h1 {
        color: #d2691e;
    }
    canvas {
        border: 2px solid #d2691e;
        border-radius: 50%;
        margin-top: 20px;
        cursor: pointer;
        max-width: 90vw;
    }
    #info {
        margin-top: 20px;
        font-size: 18px;
        color: #8b4513;
    }
    button {
        padding: 10px 20px;
        font-size: 16px;
        margin-top: 15px;
        background-color: #d2691e;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover {
        background-color: #b35915;
    }
</style>
</head>
<body>

<h1>Interactive Realistic Cake ðŸŽ‚</h1>
<p>Click on a slice to cut it!</p>
<canvas id="cakeCanvas" width="400" height="400"></canvas>
<div id="info">Number of cuts: 0 | Pieces: 1</div>
<button onclick="resetCake()">Reset Cake</button>

<script>
const canvas = document.getElementById('cakeCanvas');
const ctx = canvas.getContext('2d');
const radius = canvas.width / 2 - 10;
const center = { x: canvas.width / 2, y: canvas.height / 2 };
let slices = [{start: 0, end: 2*Math.PI}]; // start with 1 whole slice
const colors = ['#FF9999','#FFCC99','#99CCFF','#CCFF99','#FFB6C1','#FFA07A','#87CEFA','#90EE90','#FFD700','#FF69B4'];
let hoverSlice = null;

// Draw cake slices
function drawCake(highlight = null) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    slices.forEach((slice, i) => {
        // Gradient for realistic effect
        const grad = ctx.createRadialGradient(center.x, center.y, radius*0.2, center.x, center.y, radius);
        grad.addColorStop(0, colors[i % colors.length]);
        grad.addColorStop(1, '#fff2e6');

        ctx.fillStyle = grad;
        ctx.beginPath();
        ctx.moveTo(center.x, center.y);
        ctx.arc(center.x, center.y, radius, slice.start, slice.end);
        ctx.closePath();
        ctx.fill();

        // Highlight on hover
        if (highlight === i) {
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            ctx.beginPath();
            ctx.moveTo(center.x, center.y);
            ctx.arc(center.x, center.y, radius, slice.start, slice.end);
            ctx.closePath();
            ctx.fill();
        }

        // Slice borders
        ctx.strokeStyle = '#8B4513';
        ctx.lineWidth = 2;
        ctx.stroke();

        // Slice number
        const midAngle = (slice.start + slice.end) / 2;
        const textX = center.x + (radius/2) * Math.cos(midAngle);
        const textY = center.y + (radius/2) * Math.sin(midAngle);
        ctx.fillStyle = '#5C4033';
        ctx.font = 'bold 16px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(i+1, textX, textY);
    });
}

// Find which slice is clicked
function getSliceIndex(x, y) {
    const angle = Math.atan2(y - center.y, x - center.x);
    return slices.findIndex(s => {
        if (s.start < s.end) return angle >= s.start && angle <= s.end;
        else return angle >= s.start || angle <= s.end; // wrap around
    });
}

// Animate the cut
function animateCut(sliceIndex, angle) {
    const slice = slices[sliceIndex];
    const steps = 10;
    let currentStep = 0;

    function step() {
        if (currentStep <= steps) {
            const tempAngle = slice.start + (angle - slice.start) * (currentStep / steps);
            const newSlices = [
                {start: slice.start, end: tempAngle},
                {start: tempAngle, end: slice.end}
            ];
            const tempSlices = slices.slice(0, sliceIndex).concat(newSlices, slices.slice(sliceIndex+1));
            drawCake();
            slices = tempSlices;
            currentStep++;
            requestAnimationFrame(step);
        } else {
            drawCake();
        }
    }
    step();
}

// Handle click
function addCut(event) {
    const rect = canvas.getBoundingClientRect();
    const x = (event.clientX || event.touches[0].clientX) - rect.left;
    const y = (event.clientY || event.touches[0].clientY) - rect.top;
    const index = getSliceIndex(x, y);
    if (index === -1) return;

    const slice = slices[index];
    const clickAngle = Math.atan2(y - center.y, x - center.x);
    animateCut(index, clickAngle);

    // Finalize the slice after animation
    const newSlices = [
        {start: slice.start, end: clickAngle},
        {start: clickAngle, end: slice.end}
    ];
    slices.splice(index, 1, ...newSlices);

    document.getElementById('info').innerText = `Number of cuts: ${slices.length-1} | Pieces: ${slices.length}`;
}

// Hover effect
canvas.addEventListener('mousemove', e => {
    const rect = canvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    hoverSlice = getSliceIndex(x, y);
    drawCake(hoverSlice);
});

// Reset cake
function resetCake() {
    slices = [{start:0, end:2*Math.PI}];
    drawCake();
    document.getElementById('info').innerText = 'Number of cuts: 0 | Pieces: 1';
}

// Event listeners
canvas.addEventListener('click', addCut);
canvas.addEventListener('touchstart', function(e){
    e.preventDefault();
    addCut(e);
}, {passive:false});

// Initial draw
drawCake();
</script>

</body>
</html>
