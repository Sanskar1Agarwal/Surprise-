<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Happy Birthday ðŸŽˆ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
    margin:0;
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:linear-gradient(#fff0f5,#ffe4ec);
    font-family:Arial,sans-serif;
}
.page{
    display:none;
    flex-direction:column;
    align-items:center;
    width:100%;
}
.page.active{display:flex}
h1{
    color:#d6336c;
    font-size:clamp(32px,7vw,56px);
    white-space:nowrap;
    margin-bottom:20px;
}
button{
    padding:14px 32px;
    font-size:18px;
    border:none;
    border-radius:30px;
    background:#ff4d6d;
    color:#fff;
    cursor:pointer;
}
canvas{
    width:100%;
    max-width:520px;
    height:auto;
}
</style>
</head>

<body>

<!-- PAGE 1 -->
<div id="page1" class="page active">
    <h1>Happy Birthday ðŸŽˆ</h1>
    <button onclick="start()">Cut the Cake ðŸŽ‚</button>
</div>

<!-- PAGE 2 -->
<div id="page2" class="page">
    <canvas id="cake" width="520" height="520"></canvas>
</div>

<script>
const canvas = document.getElementById("cake");
const ctx = canvas.getContext("2d");

const center = { x:260, y:270 };
const R = 160;
const H = 70;

let cuts = 0;
const maxCuts = 6;

/* ===== SPRINKLES ===== */
function generateSprinkles(a0,a1,count=18){
    const colors=["#ff4d6d","#ffd166","#4dabf7","#51cf66","#f783ac"];
    const arr=[];
    for(let i=0;i<count;i++){
        arr.push({
            angle:a0+Math.random()*(a1-a0),
            radius:30+Math.random()*(R-50),
            color:colors[Math.floor(Math.random()*colors.length)]
        });
    }
    return arr;
}

/* ===== INITIAL SLICE ===== */
let slices=[{
    a0:0,
    a1:Math.PI*2,
    pull:0,
    sprinkles:generateSprinkles(0,Math.PI*2,30)
}];

/* ===== CUT FACE ===== */
function drawCutFace(cx,cy,angle){
    const x=cx+R*Math.cos(angle);
    const y=cy+R*Math.sin(angle);
    ctx.fillStyle="#a0522d";
    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.lineTo(x,y);
    ctx.lineTo(x,y+H);
    ctx.lineTo(cx,cy+H);
    ctx.closePath();
    ctx.fill();
}

/* ===== DRAW SLICE ===== */
function drawSlice(s){
    const mid=(s.a0+s.a1)/2;
    const dx=s.pull*Math.cos(mid);
    const dy=s.pull*Math.sin(mid);
    const cx=center.x+dx;
    const cy=center.y+dy;

    /* Sponge */
    ctx.fillStyle="#8b4513";
    ctx.beginPath();
    ctx.arc(cx,cy+H,R,s.a0,s.a1);
    ctx.arc(cx,cy,R,s.a1,s.a0,true);
    ctx.closePath();
    ctx.fill();

    drawCutFace(cx,cy,s.a0);
    drawCutFace(cx,cy,s.a1);

    /* Cream Top */
    ctx.fillStyle="#ff8fab";
    ctx.beginPath();
    ctx.moveTo(cx,cy);
    ctx.arc(cx,cy,R,s.a0,s.a1);
    ctx.closePath();
    ctx.fill();

    /* Sprinkles */
    s.sprinkles.forEach(sp=>{
        const x=cx+sp.radius*Math.cos(sp.angle);
        const y=cy+sp.radius*Math.sin(sp.angle);
        ctx.fillStyle=sp.color;
        ctx.beginPath();
        ctx.ellipse(x,y,3,1.5,sp.angle,0,Math.PI*2);
        ctx.fill();
    });
}

/* ===== DRAW CAKE (DEPTH SORTED) ===== */
function drawCake(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    [...slices]
        .sort((a,b)=>Math.sin((a.a0+a.a1)/2)-Math.sin((b.a0+b.a1)/2))
        .forEach(drawSlice);
}

/* ===== CUT ACTION ===== */
canvas.onclick=()=>{
    if(cuts>=maxCuts) return;
    cuts++;
    const step=Math.PI*2/(cuts+1);
    slices=[];
    for(let i=0;i<cuts+1;i++){
        slices.push({
            a0:i*step,
            a1:(i+1)*step,
            pull:35,
            sprinkles:generateSprinkles(i*step,(i+1)*step)
        });
    }
};

/* ===== PAGE SWITCH ===== */
function start(){
    document.querySelector(".page.active").classList.remove("active");
    document.getElementById("page2").classList.add("active");
}

/* LOOP */
(function loop(){
    drawCake();
    requestAnimationFrame(loop);
})();
</script>

</body>
</html>
